{"version":3,"sources":["../../src/utils/network.js"],"names":["networkManager","init","store","client","url","then","dispatch","type","subscribe","getState","connection","established","listening","onmessage","payload","JSON","parse","res","data"],"mappings":";;;;;;AACA;;AAQA,IAAMA,iBAAiB;AACnBC,QADmB,sBACU;AAAA,YAAtBC,KAAsB,QAAtBA,KAAsB;AAAA,YAAfC,MAAe,QAAfA,MAAe;AAAA,YAAPC,GAAO,QAAPA,GAAO;;AACzBD,eAAOF,IAAP,CAAYG,GAAZ,EAAiBC,IAAjB,CAAsB,aAAK;AACvBH,kBAAMI,QAAN,CAAe,EAAEC,yCAAF,EAAf;AACH,SAFD;AAGAL,cAAMM,SAAN,CAAgB,YAAM;AAClB,gBAAIN,MAAMO,QAAN,GAAiBC,UAAjB,CAA4BC,WAA5B,IAA2C,CAACT,MAAMO,QAAN,GAAiBC,UAAjB,CAA4BE,SAA5E,EAAuF;AACnFT,uBAAOU,SAAP,CAAiB,eAAO;AACpBX,0BAAMI,QAAN,CAAe,EAAEC,8BAAF,EAAqBO,SAASC,KAAKC,KAAL,CAAWC,IAAIC,IAAf,CAA9B,EAAf;AACH,iBAFD;AAGAhB,sBAAMI,QAAN,CAAe,EAAEC,uCAAF,EAAf;AACH;AACJ,SAPD;AAQH;AAbkB,CAAvB,C,CATA;kBAyBeP,c","file":"network.js","sourcesContent":["// @ts-check\nimport {\n    MESSAGE_ADD,\n    CONNECTION_ESTABLISHED,\n    CONNECTION_ATTEMPTED,\n    CONNECTION_DROPPED,\n    CONNECTION_LISTENING\n} from '../actionTypes';\n\nconst networkManager = {\n    init({ store, client, url }) {\n        client.init(url).then(_ => {\n            store.dispatch({ type: CONNECTION_ESTABLISHED });\n        });\n        store.subscribe(() => {\n            if (store.getState().connection.established && !store.getState().connection.listening) {\n                client.onmessage(res => {\n                    store.dispatch({ type: MESSAGE_ADD, payload: JSON.parse(res.data) });\n                });\n                store.dispatch({ type: CONNECTION_LISTENING });\n            }\n        });\n    }\n};\n\nexport default networkManager;\n"]}